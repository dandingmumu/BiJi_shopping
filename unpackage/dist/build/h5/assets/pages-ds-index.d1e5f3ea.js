import{c as t,g as a,a as e,n as s,o as i,b as o,d as n,w as l,F as c,r as d,e as r,f as h,l as u,p as f,m as p,i as m,t as _,j as y,q as g}from"./index.59bb86cc.js";import{T as L,a as C,g as w,b as v,c as S,d as x}from"./home.897ac596.js";import{_ as b}from"./plugin-vue_export-helper.21dcd24c.js";var B=b({components:{Tabbar:L},data:()=>({cityName:"暂未选择",cityAdCode:0,adCode:0,annunciateOverlayShow:!1,shoppingBanner:[],cityClassifyListData:[],cityClassifyListMeterValue:0,cityClassifyListMeterData:[{meter:1,text:"500M"},{meter:1,text:"1KM"},{meter:1,text:"3KM"},{meter:1,text:"5KM"},{meter:1,text:"10KM"}],cityNames:"全部",recommendValue:0,recommendOptions:[{text:"推荐",value:0},{text:"距离优先",value:1},{text:"销量优先",value:2},{text:"价格优先",value:3}],handleVanStickyShow:!0,areaShow:!1,loading:!1,finished:!1,onLoad:!1,productListData:[],productWhere:{cityAdCode:0,meter:0,page:1,page_size:10,total:0},userInfo:t.get("USER_INFO")}),setup:()=>({areaList:C}),onLoad(){const t=this;a({type:"wgs84",success:function(a){t.getLocation(a.latitude+","+a.longitude)}}),this.userInfo=JSON.parse(this.userInfo)},onShow(){e({title:this.cityName})},methods:{getLocation(t){w(t).then((t=>{const a=t.data.result.ad_info;this.cityName=a.city,this.getCityClassifyList(a.city_code.slice(3)-0),this.getBannerList(a.city_code.slice(3)-0)})).catch((t=>{console.log("请求失败"+t)}))},handleAreaSubmit(t){e({title:t[1].name}),this.cityName=t[1].name,this.areaShow=!1,this.getCityClassifyList(t[1].code)},getBannerList(t){v(t).then((t=>{this.shoppingBanner=t.data})).catch((t=>{console.log("请求错误"+t)}))},handleVanSticky(t){this.handleVanStickyShow=!t},handleAreaShow(t){this.areaShow=t},getCityClassifyList(t){S(t).then((t=>{this.cityClassifyListData=t.data})).catch((t=>{console.log("请求错误: "+t)}))},getProductList(t){x({page:this.productWhere.page,limit:this.productWhere.page_size}).then((t=>{0===t.data.list.length&&(this.productListData=[],this.finished=!0),this.productWhere.total=t.data.count,this.productListData.push(...t.data.list),this.loading=!1,this.productListData.length>=t.data.count&&(this.finished=!0)})).catch((t=>{console.log("请求错误: "+t)}))},handleOnLoad(){let t=setTimeout((()=>{this.getProductList(this.productWhere),this.productWhere.page++,this.finished&&clearTimeout(t)}),100)},handleCityClick(t,a=""){this.adCode=t,0!=t&&this.$refs.cityListDropdownItem.toggle()},handleCityMeterClick(t,a=""){this.cityClassifyListMeterValue=t},gotoDetail(t){s({url:"../details/index?id="+t})}}},[["render",function(t,a,e,s,L,C){const w=g,v=f,S=p("van-list"),x=p("van-icon"),b=p("van-overlay"),B=p("van-area"),k=p("van-popup"),D=p("tabbar");return i(),o(c,null,[n(v,{class:"content"},{default:l((()=>[n(v,{class:"shopping-productList"},{default:l((()=>[n(S,{loading:L.loading,"onUpdate:loading":a[0]||(a[0]=t=>L.loading=t),finished:L.finished,"finished-text":"没有更多了",onLoad:C.handleOnLoad},{default:l((()=>[(i(!0),o(c,null,d(L.productListData,((t,a)=>(i(),m(v,{key:a,class:"shopping-productListItem",onClick:a=>C.gotoDetail(t.id)},{default:l((()=>[n(v,{class:"infoImg"},{default:l((()=>[n(w,{src:t.recommend_image,mode:"aspectFill"},null,8,["src"])])),_:2},1024),n(v,{class:"infoDescription"},{default:l((()=>[h(_(t.selling_point),1)])),_:2},1024),n(v,{class:"unitPrice"},{default:l((()=>[n(v,null,{default:l((()=>[r("span",{class:"price"},"￥"),r("span",{class:"money"},_(t.preferential_price),1)])),_:2},1024),n(v,{class:"rackRate"},{default:l((()=>[h("门市价￥"+_(t.unit_price),1)])),_:2},1024),null!=L.userInfo&&0!=L.userInfo.is_expert?(i(),m(v,{key:0,class:"return"},{default:l((()=>[r("span",{class:"fan"},"返"),r("span",{class:"fanMoney"},"￥"+_(t.rebate),1)])),_:2},1024)):y("",!0)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1},8,["loading","finished","onLoad"])])),_:1})])),_:1}),n(b,{"z-index":"1000",show:L.annunciateOverlayShow},{default:l((()=>[r("div",{class:"wrapper",onClick:a[2]||(a[2]=u((()=>{}),["stop"]))},[r("div",{class:"frame"},[n(v,{class:"frameBg"},{default:l((()=>[n(v,{class:"frameBg__title"},{default:l((()=>[h(" 放心买，随心退 ")])),_:1})])),_:1}),n(v,{class:"frameBody"},{default:l((()=>[n(v,{class:"frameBody__title"},{default:l((()=>[h("随心退是什么？")])),_:1}),n(v,{class:"frameBody__content"},{default:l((()=>[h("在爆品商城里购买的商品，在未使用核销的情况下可享受退款无服务费的权益。")])),_:1}),n(v,{class:"frameBody__title"},{default:l((()=>[h("哪些商品可以享受随心退？")])),_:1}),n(v,{class:"frameBody__content"},{default:l((()=>[h("在爆品商城里购买的商品，在未使用核销的情况下可享受退款无服务费的权益。")])),_:1}),n(v,{class:"frameBody__title"},{default:l((()=>[h("已经过期的订单是否可以随心退？")])),_:1}),n(v,{class:"frameBody__content"},{default:l((()=>[h("在爆品商城里购买的商品，在未使用核销的情况下可享受退款无服务费的权益。")])),_:1})])),_:1})]),r("div",{class:"frameClose"},[n(x,{name:"close",size:"65rpx",onClick:a[1]||(a[1]=t=>L.annunciateOverlayShow=!1)})])])])),_:1},8,["show"]),n(k,{show:L.areaShow,"onUpdate:show":a[4]||(a[4]=t=>L.areaShow=t),round:"",position:"bottom"},{default:l((()=>[n(B,{title:"选择城市","confirm-button-text":"","area-list":s.areaList,value:L.cityAdCode,"columns-num":2,onCancel:a[3]||(a[3]=t=>C.handleAreaShow(!1)),onConfirm:C.handleAreaSubmit},null,8,["area-list","value","onConfirm"])])),_:1},8,["show"]),n(D)],64)}],["__scopeId","data-v-43a32394"]]);export{B as default};
